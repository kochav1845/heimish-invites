import{l as t,e as i}from"./utils-_FgEgy2s.js";import"./vendor-DgCBCQ6H.js";function s(){class s extends HTMLElement{constructor(){super(),this.animationFrameId=null,this.boundResize=this.onResize.bind(this),this.boundTick=this.tick.bind(this)}connectedCallback(){this.canvas=this.querySelector(".js-canvas"),this.ctx=this.canvas.getContext("2d"),this.discs=[],this.lines=[],this.setSize(),this.setDiscs(),this.setLines(),this.setParticles(),this.bindEvents(),this.animationFrameId=requestAnimationFrame(this.boundTick)}disconnectedCallback(){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),window.removeEventListener("resize",this.boundResize)}bindEvents(){window.addEventListener("resize",this.boundResize)}onResize(){this.setSize(),this.setDiscs(),this.setLines(),this.setParticles()}setSize(){this.rect=this.getBoundingClientRect(),this.render={width:this.rect.width,height:this.rect.height,dpi:window.devicePixelRatio},this.canvas.width=this.render.width*this.render.dpi,this.canvas.height=this.render.height*this.render.dpi}setDiscs(){const{width:t,height:i}=this.rect;this.discs=[],this.startDisc={x:.5*t,y:.45*i,w:.75*t,h:.7*i},this.endDisc={x:.5*t,y:.95*i,w:0,h:0};let s=i;this.clip={};for(let e=0;e<100;e++){const t=e/100,i=this.tweenDisc({p:t}),h=i.y+i.h;h<=s&&(this.clip={disc:{...i},i:e}),s=h,this.discs.push(i)}this.clip.path=new Path2D,this.clip.path.ellipse(this.clip.disc.x,this.clip.disc.y,this.clip.disc.w,this.clip.disc.h,0,0,2*Math.PI),this.clip.path.rect(this.clip.disc.x-this.clip.disc.w,0,2*this.clip.disc.w,this.clip.disc.y)}setLines(){const{width:t,height:i}=this.rect;this.lines=[];const s=2*Math.PI/100;for(let h=0;h<100;h++)this.lines.push([]);this.discs.forEach((t=>{for(let i=0;i<100;i++){const e=i*s,h={x:t.x+Math.cos(e)*t.w,y:t.y+Math.sin(e)*t.h};this.lines[i].push(h)}})),this.linesCanvas=new OffscreenCanvas(t,i);const e=this.linesCanvas.getContext("2d");this.lines.forEach((t=>{e.save();let i=!1;t.forEach(((s,h)=>{if(0===h)return;const c=t[h-1];i||!e.isPointInPath(this.clip.path,s.x,s.y)&&!e.isPointInStroke(this.clip.path,s.x,s.y)?i&&e.clip(this.clip.path):i=!0,e.beginPath(),e.moveTo(c.x,c.y),e.lineTo(s.x,s.y),e.strokeStyle="#444",e.lineWidth=2,e.stroke(),e.closePath()})),e.restore()})),this.linesCtx=e}setParticles(){const{width:t,height:i}=this.rect;this.particles=[],this.particleArea={sw:.5*this.clip.disc.w,ew:2*this.clip.disc.w,h:.85*i},this.particleArea.sx=(t-this.particleArea.sw)/2,this.particleArea.ex=(t-this.particleArea.ew)/2;for(let s=0;s<100;s++){const t=this.initParticle(!0);this.particles.push(t)}}initParticle(t=!1){const i=this.particleArea.sx+this.particleArea.sw*Math.random(),s=this.particleArea.ex+this.particleArea.ew*Math.random()-i,e=t?this.particleArea.h*Math.random():this.particleArea.h,h=.5+4*Math.random();return{x:i,sx:i,dx:s,y:e,vy:.5+Math.random(),p:0,r:h,c:`rgba(255, 255, 255, ${Math.random()})`}}tweenValue(s,e,h,c=!1){const a=e-s;let n;if(c){const s="ease"+c.charAt(0).toUpperCase()+c.slice(1);n=i[s]||t}else n=t;return"function"==typeof n?s+a*n(h):s+a*t(h)}drawDiscs(){const{ctx:t}=this;t.strokeStyle="#444",t.lineWidth=2;const i=this.startDisc;t.beginPath(),t.ellipse(i.x,i.y,i.w,i.h,0,0,2*Math.PI),t.stroke(),t.closePath(),this.discs.forEach(((i,s)=>{s%5==0&&(i.w<this.clip.disc.w-5&&(t.save(),t.clip(this.clip.path)),t.beginPath(),t.ellipse(i.x,i.y,i.w,i.h,0,0,2*Math.PI),t.stroke(),t.closePath(),i.w<this.clip.disc.w-5&&t.restore())}))}drawLines(){if(!this.linesCanvas||!this.ctx)return;const{ctx:t,linesCanvas:i}=this;t.drawImage(i,0,0)}drawParticles(){const{ctx:t}=this;t.save(),t.clip(this.clip.path),this.particles.forEach((i=>{t.fillStyle=i.c,t.beginPath(),t.rect(i.x,i.y,i.r,i.r),t.closePath(),t.fill()})),t.restore()}moveDiscs(){this.discs.forEach((t=>{t.p=(t.p+.001)%1,this.tweenDisc(t)}))}moveParticles(){this.particles.forEach((t=>{t.p=1-t.y/this.particleArea.h,t.x=t.sx+t.dx*t.p,t.y-=t.vy,t.y<0&&(t.y=this.initParticle().y)}))}tweenDisc(t){return t.x=this.tweenValue(this.startDisc.x,this.endDisc.x,t.p),t.y=this.tweenValue(this.startDisc.y,this.endDisc.y,t.p,"inExpo"),t.w=this.tweenValue(this.startDisc.w,this.endDisc.w,t.p),t.h=this.tweenValue(this.startDisc.h,this.endDisc.h,t.p),t}tick(t){if(!this.ctx||!this.canvas)return;const{ctx:i}=this;i.clearRect(0,0,this.canvas.width,this.canvas.height),i.save(),i.scale(this.render.dpi,this.render.dpi),this.moveDiscs(),this.moveParticles(),this.drawDiscs(),this.drawLines(),this.drawParticles(),i.restore(),this.animationFrameId=requestAnimationFrame(this.boundTick)}}customElements.get("a-hole")||customElements.define("a-hole",s)}export{s as default};
